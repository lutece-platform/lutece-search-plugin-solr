<?xml version="1.0" encoding="UTF-8"?>
<document>
	<properties>
		<title>Lutece : Solr</title>
	</properties>
	<body>
		<section name="Solr">
			<subsection name="Introduction">
				<p>Plugin to change the default search engine in Lutece (based on lucene) by Solr server.</p>
				<p>Its major features include powerful full-text search, hit highlighting, faceted search, auto-suggest, spelling suggestions ...</p>
			</subsection>
			<subsection name="Install">
				<p>Download Solr 1.4 from source : http://svn.apache.org/repos/asf/lucene/solr/tags/release-1.4.0</p>
				<p>Apply <a href="http://issues.apache.org/jira/browse/SOLR-64">SOLR-64</a>
				and <a href="http://issues.apache.org/jira/browse/SOLR-792">SOLR-792</a></p>
			</subsection>
			<subsection name="Re-index all periodically">
			<p>To re-index all content from scratch, one can use the following JSP which can be call from a CRON (ex: every weekend)</p>
<pre>
&lt;servlet&gt;
        &lt;servlet-name&gt;SolrServlet&lt;/servlet-name&gt;
        &lt;servlet-class&gt;fr.paris.lutece.plugins.search.solr.web.SolrSuggestServlet&lt;/servlet-class&gt;
    &lt;/servlet&gt;
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;SolrServlet&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/solrSuggest&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
</pre>
			</subsection>

			<subsection name="Configuration de la XPage search-solr">
            <p>Sur la xpage search-solr, on peut utiliser des configurations différentes en ajoutant le parametre de query "conf=XXX". Les configurations ont les parametres suivants:</p>
            <ul>
                <li>mapping: display results on a map</li>
                <li>fq: applique des filtres coté serveur en plus de ceux de la requète</li>
                <li>template: definit le template freemarker à utiliser à la place du template par défaut "skin/search/solr_search_results.html"</li>
                <li>addonBeans.X: utilise des beans spring implémentant l'interface ISolrSearchAppAddOn pour ajouter des données au modèle freemarker. Plusieurs beans peuvent être utilisés en donnant plusieurs valeurs à ce paramètre avec différentes valeurs pour "X" (par convention "0", "1" ...)</li>
            </ul>
            <p>Pour créer et éditer les configurations, il suffit d'insérer ou de modifier des clefs du datastore: solr.app.conf.XXX.YYY où XXX est le nom de la configuration qui sera utilisé dans l'URL de la xpage, et YYY le nom du paramètre à modifier. Par convention, on ajoute aussi la clef datastore solr.app.conf.XXX.installed avec la valeur "true"</p>
			</subsection>
			
		</section>
		<section/>
	</body>
</document>
